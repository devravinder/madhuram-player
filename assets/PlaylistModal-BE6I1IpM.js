import{t as e}from"./check-DHRyHzAa.js";import{t}from"./trash-2-CcrJVY1k.js";import{E as n,O as r,R as i,T as a,X as o,Y as s,_ as c,at as l,dt as u,p as ee,q as te,st as d,u as ne,v as f,x as re,y as ie}from"./index-CXro6f2U.js";var p=u(d(),1);function m(e,t,n){var r,i;typeof e==`function`?(r=t||[],i=n):(r=[],i=t);var a=p.useRef({hasResult:!1,result:i,error:null}),o=p.useReducer(function(e){return e+1},0);o[0];var s=o[1],c=p.useMemo(function(){var t=typeof e==`function`?e():e;if(!t||typeof t.subscribe!=`function`)throw e===t?TypeError(`Given argument to useObservable() was neither a valid observable nor a function.`):TypeError(`Observable factory given to useObservable() did not return a valid observable.`);if(!a.current.hasResult&&typeof window<`u`&&(typeof t.hasValue!=`function`||t.hasValue()))if(typeof t.getValue==`function`)a.current.result=t.getValue(),a.current.hasResult=!0;else{var n=t.subscribe(function(e){a.current.result=e,a.current.hasResult=!0});typeof n==`function`?n():n.unsubscribe()}return t},r);if(p.useDebugValue(a.current.result),p.useEffect(function(){var e=c.subscribe(function(e){var t=a.current;(t.error!==null||t.result!==e)&&(t.error=null,t.result=e,t.hasResult=!0,s())},function(e){var t=a.current;t.error!==e&&(t.error=e,s())});return typeof e==`function`?e:e.unsubscribe.bind(e)},r),a.current.error)throw a.current.error;return a.current.result}function ae(e,t,r){return m(function(){return n.liveQuery(e)},t||[],r)}typeof FinalizationRegistry<`u`&&new FinalizationRegistry(function(e){var t=n.DexieYProvider;t&&t.release(e)});var oe=l(),h=s();function g(n){let r=(0,oe.c)(71),{title:a,playlist:s,onClose:l}=n,u=ae(ce),{setFavourites:d}=c(),m=te(),g=s.id,[_,v]=(0,p.useState)(s.name),[y,b]=(0,p.useState)(s.description||``),x;r[0]===s.songIds?x=r[1]:(x=new Set(s.songIds),r[0]=s.songIds,r[1]=x);let[S,C]=(0,p.useState)(x),w;r[2]!==s.description||r[3]!==s.name||r[4]!==s.songIds?(w=()=>{v(s.name),b(s.description||``),C(new Set(s.songIds))},r[2]=s.description,r[3]=s.name,r[4]=s.songIds,r[5]=w):w=r[5];let T;r[6]===s?T=r[7]:(T=[s],r[6]=s,r[7]=T),(0,p.useEffect)(w,T);let E;r[8]!==y||r[9]!==_||r[10]!==l||r[11]!==s.id||r[12]!==S||r[13]!==d?(E=()=>{let e=[...S];s.id?(re(s.id,{name:_,description:y||void 0,songIds:e}),s.id===`favourites`&&d(e)):f({name:_,description:y,songIds:e}),l()},r[8]=y,r[9]=_,r[10]=l,r[11]=s.id,r[12]=S,r[13]=d,r[14]=E):E=r[14];let D=E,O;r[15]!==g||r[16]!==m||r[17]!==l||r[18]!==s.id?(O=()=>{g&&(ie(s.id),l(),m({to:`/playlists`}))},r[15]=g,r[16]=m,r[17]=l,r[18]=s.id,r[19]=O):O=r[19];let k=O,A;r[20]===Symbol.for(`react.memo_cache_sentinel`)?(A=e=>{C(t=>{let n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},r[20]=A):A=r[20];let le=A,j;r[21]===a?j=r[22]:(j=(0,h.jsx)(`h2`,{className:`text-xl font-bold`,children:a}),r[21]=a,r[22]=j);let M;r[23]===Symbol.for(`react.memo_cache_sentinel`)?(M=(0,h.jsx)(o,{size:20}),r[23]=M):M=r[23];let N;r[24]===l?N=r[25]:(N=(0,h.jsx)(`button`,{onClick:l,className:`cursor-pointer absolute top-8 right-8 p-2.5 bg-black/30 backdrop-blur-sm rounded-full hover:bg-black/50 transition-all`,children:M}),r[24]=l,r[25]=N);let P;r[26]!==j||r[27]!==N?(P=(0,h.jsxs)(`div`,{className:`px-8 py-4 flex items-center justify-between `,children:[j,N]}),r[26]=j,r[27]=N,r[28]=P):P=r[28];let F;r[29]===Symbol.for(`react.memo_cache_sentinel`)?(F=(0,h.jsx)(`label`,{className:`block text-sm font-medium mb-2`,children:`Name`}),r[29]=F):F=r[29];let I;r[30]===Symbol.for(`react.memo_cache_sentinel`)?(I=e=>v(e.target.value),r[30]=I):I=r[30];let L;r[31]===_?L=r[32]:(L=(0,h.jsxs)(`div`,{children:[F,(0,h.jsx)(i,{type:`text`,value:_,onChange:I,className:`input-field`})]}),r[31]=_,r[32]=L);let R;r[33]===Symbol.for(`react.memo_cache_sentinel`)?(R=(0,h.jsx)(`label`,{className:`block text-sm font-medium mb-2`,children:`Description`}),r[33]=R):R=r[33];let z;r[34]===Symbol.for(`react.memo_cache_sentinel`)?(z=e=>b(e.target.value),r[34]=z):z=r[34];let B;r[35]===y?B=r[36]:(B=(0,h.jsxs)(`div`,{children:[R,(0,h.jsx)(i,{as:`textarea`,value:y,onChange:z,className:`input-field resize-none h-16`})]}),r[35]=y,r[36]=B);let V;r[37]===Symbol.for(`react.memo_cache_sentinel`)?(V=(0,h.jsx)(`label`,{className:`block text-sm font-medium mb-2`,children:`Select Songs`}),r[37]=V):V=r[37];let H;r[38]===u?H=r[39]:(H=u||[],r[38]=u,r[39]=H);let U;if(r[40]!==S||r[41]!==H){let t;r[43]===S?t=r[44]:(t=t=>(0,h.jsxs)(`button`,{onClick:()=>le(t.id),className:`w-full flex items-center gap-3 p-2 rounded-lg transition-colors ${S.has(t.id)?`bg-primary/20 text-primary`:`hover:bg-secondary`}`,children:[(0,h.jsx)(ne,{id:t.coverImageId,alt:t.title,className:`w-10 h-10 rounded`}),(0,h.jsxs)(`div`,{className:`flex-1 text-left min-w-0`,children:[(0,h.jsx)(`p`,{className:`text-sm font-medium truncate`,children:t.title}),(0,h.jsx)(`p`,{className:`text-xs text-muted-foreground truncate`,children:t.artist})]}),S.has(t.id)&&(0,h.jsx)(e,{size:18,className:`text-primary`})]},t.id),r[43]=S,r[44]=t),U=H.map(t),r[40]=S,r[41]=H,r[42]=U}else U=r[42];let W;r[45]===U?W=r[46]:(W=(0,h.jsxs)(`div`,{children:[V,(0,h.jsx)(`div`,{className:`space-y-2 max-h-48 overflow-y-auto border border-border rounded-xl p-2`,children:U})]}),r[45]=U,r[46]=W);let G;r[47]!==L||r[48]!==B||r[49]!==W?(G=(0,h.jsxs)(`div`,{className:`px-8 space-y-4 flex-1 overflow-y-auto`,children:[L,B,W]}),r[47]=L,r[48]=B,r[49]=W,r[50]=G):G=r[50];let K;r[51]!==g||r[52]!==k?(K=g&&(0,h.jsxs)(`button`,{onClick:k,className:`cursor-pointer p-2 px-4 rounded-lg text-destructive hover:text-primary hover:bg-accent/70 flex items-center gap-2`,children:[(0,h.jsx)(t,{size:18}),`Delete`]}),r[51]=g,r[52]=k,r[53]=K):K=r[53];let q;r[54]===l?q=r[55]:(q=(0,h.jsx)(`button`,{onClick:l,className:`cursor-pointer p-2 px-4 rounded-lg bg-primary/20 hover:bg-primary/30 text-primary`,children:`Cancel`}),r[54]=l,r[55]=q);let J;r[56]===_?J=r[57]:(J=_.trim(),r[56]=_,r[57]=J);let Y=!J,X;r[58]!==D||r[59]!==Y?(X=(0,h.jsx)(`button`,{onClick:D,className:`cursor-pointer p-2 px-4 rounded-lg bg-primary hover:bg-primary/90 text-secondary`,disabled:Y,children:`Save`}),r[58]=D,r[59]=Y,r[60]=X):X=r[60];let Z;r[61]!==q||r[62]!==X?(Z=(0,h.jsxs)(`div`,{className:`flex-1 flex flex-row justify-end gap-4`,children:[q,X]}),r[61]=q,r[62]=X,r[63]=Z):Z=r[63];let Q;r[64]!==K||r[65]!==Z?(Q=(0,h.jsxs)(`div`,{className:`px-8 pt-4 flex flex-row justify-between border-t border-border`,children:[K,Z]}),r[64]=K,r[65]=Z,r[66]=Q):Q=r[66];let $;return r[67]!==P||r[68]!==G||r[69]!==Q?($=(0,h.jsx)(ee,{children:(0,h.jsx)(`div`,{className:`w-full max-w-md mx-auto h-full p-8 flex flex-col`,children:(0,h.jsxs)(`div`,{className:`relative py-4 flex-1 min-h-0 flex flex-col gap-4 bg-linear-to-br from-slate-900 to-slate-800 rounded-3xl shadow-2xl`,onClick:se,children:[P,G,Q]})})}),r[67]=P,r[68]=G,r[69]=Q,r[70]=$):$=r[70],$}function se(e){return e.stopPropagation()}function ce(){return a.songs.toArray()}export{g as t};