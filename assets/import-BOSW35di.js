const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MpegParser-Dv31HPmm.js","assets/index-BQTJh7E3.js","assets/index-C8wfn6nC.css","assets/BasicParser-C54WsfEg.js","assets/APEv2Parser-sZtNmjs-.js","assets/Util-ur9RbiZX.js","assets/core-BwrZC3T8.js","assets/ID3v1Parser-lwsX5viR.js","assets/AbstractID3Parser-C37Hk4ho.js","assets/ID3v2Parser-BPMwNOef.js","assets/ID3v2Token-9FaZf3rF.js","assets/APEv2Parser-BIvlT_8k.js","assets/AsfParser-CNoLttF9.js","assets/types-CEOlc4r7.js","assets/DsdiffParser-DS9Zbw_z.js","assets/AiffParser-DeEBWuiR.js","assets/DsfParser-D2L0jsK3.js","assets/FlacParser-vrFmITD9.js","assets/FlacParser-Dctk7C3f.js","assets/MatroskaParser-CV7Kr9Ox.js","assets/MP4Parser-AX0GHFWk.js","assets/MusepackParser-hl--qYF_.js","assets/OggParser-DsMPsRkA.js","assets/WavPackParser-CezWDVXy.js","assets/WaveParser-DE_8-d3R.js"])))=>i.map(i=>d[i]);
import{$ as e,N as t,Z as n,at as r,c as i,d as a,dt as o,ft as s,lt as c,mt as l,v as u}from"./index-BQTJh7E3.js";import{C as d,E as f,S as p,T as m,_ as h,a as g,f as _,i as v,k as ee,n as y,s as b,v as x,y as S}from"./BasicParser-C54WsfEg.js";import{i as C,n as w,r as T,t as E}from"./core-BwrZC3T8.js";import{d as D,l as O,n as k}from"./Util-ur9RbiZX.js";import{c as A,i as j}from"./ID3v2Token-9FaZf3rF.js";import{t as M}from"./APEv2Parser-sZtNmjs-.js";import{r as te}from"./ID3v1Parser-lwsX5viR.js";import{n as N,r as ne}from"./types-CEOlc4r7.js";var re=l(b(),1),ie=c(),P=l(o(),1);const F={LocalFileHeader:67324752,DataDescriptor:134695760,CentralFileHeader:33639248,EndOfCentralDirectory:101010256},I={get(e){return{signature:d.get(e,0),compressedSize:d.get(e,8),uncompressedSize:d.get(e,12)}},len:16},ae={get(e){let t=S.get(e,6);return{signature:d.get(e,0),minVersion:S.get(e,4),dataDescriptor:!!(t&8),compressedMethod:S.get(e,8),compressedSize:d.get(e,18),uncompressedSize:d.get(e,22),filenameLength:S.get(e,26),extraFieldLength:S.get(e,28),filename:null}},len:30},oe={get(e){return{signature:d.get(e,0),nrOfThisDisk:S.get(e,4),nrOfThisDiskWithTheStart:S.get(e,6),nrOfEntriesOnThisDisk:S.get(e,8),nrOfEntriesOfSize:S.get(e,10),sizeOfCd:d.get(e,12),offsetOfStartOfCd:d.get(e,16),zipFileCommentLength:S.get(e,20)}},len:22},se={get(e){let t=S.get(e,8);return{signature:d.get(e,0),minVersion:S.get(e,6),dataDescriptor:!!(t&8),compressedMethod:S.get(e,10),compressedSize:d.get(e,20),uncompressedSize:d.get(e,24),filenameLength:S.get(e,28),extraFieldLength:S.get(e,30),fileCommentLength:S.get(e,32),relativeOffsetOfLocalHeader:d.get(e,42),filename:null}},len:46};function L(e){let t=new Uint8Array(d.len);return d.put(t,0,e),t}var R=(0,re.default)(`tokenizer:inflate`),z=256*1024,ce=L(F.DataDescriptor),B=L(F.EndOfCentralDirectory),le=class e{constructor(e){this.tokenizer=e,this.syncBuffer=new Uint8Array(z)}async isZip(){return await this.peekSignature()===F.LocalFileHeader}peekSignature(){return this.tokenizer.peekToken(d)}async findEndOfCentralDirectoryLocator(){let e=this.tokenizer,t=Math.min(16*1024,e.fileInfo.size),n=this.syncBuffer.subarray(0,t);await this.tokenizer.readBuffer(n,{position:e.fileInfo.size-t});for(let r=n.length-4;r>=0;r--)if(n[r]===B[0]&&n[r+1]===B[1]&&n[r+2]===B[2]&&n[r+3]===B[3])return e.fileInfo.size-t+r;return-1}async readCentralDirectory(){if(!this.tokenizer.supportsRandomAccess()){R(`Cannot reading central-directory without random-read support`);return}R(`Reading central-directory...`);let e=this.tokenizer.position,t=await this.findEndOfCentralDirectoryLocator();if(t>0){R(`Central-directory 32-bit signature found`);let n=await this.tokenizer.readToken(oe,t),r=[];this.tokenizer.setPosition(n.offsetOfStartOfCd);for(let e=0;e<n.nrOfEntriesOfSize;++e){let t=await this.tokenizer.readToken(se);if(t.signature!==F.CentralFileHeader)throw Error(`Expected Central-File-Header signature`);t.filename=await this.tokenizer.readToken(new h(t.filenameLength,`utf-8`)),await this.tokenizer.ignore(t.extraFieldLength),await this.tokenizer.ignore(t.fileCommentLength),r.push(t),R(`Add central-directory file-entry: n=${e+1}/${r.length}: filename=${r[e].filename}`)}return this.tokenizer.setPosition(e),r}this.tokenizer.setPosition(e)}async unzip(e){let t=await this.readCentralDirectory();if(t)return this.iterateOverCentralDirectory(t,e);let n=!1;do{let t=await this.readLocalFileHeader();if(!t)break;let r=e(t);n=!!r.stop;let i;if(await this.tokenizer.ignore(t.extraFieldLength),t.dataDescriptor&&t.compressedSize===0){let e=[],n=z;R(`Compressed-file-size unknown, scanning for next data-descriptor-signature....`);let i=-1;for(;i<0&&n===z;){n=await this.tokenizer.peekBuffer(this.syncBuffer,{mayBeLess:!0}),i=ue(this.syncBuffer.subarray(0,n),ce);let t=i>=0?i:n;if(r.handler){let n=new Uint8Array(t);await this.tokenizer.readBuffer(n),e.push(n)}else await this.tokenizer.ignore(t)}R(`Found data-descriptor-signature at pos=${this.tokenizer.position}`),r.handler&&await this.inflate(t,de(e),r.handler)}else r.handler?(R(`Reading compressed-file-data: ${t.compressedSize} bytes`),i=new Uint8Array(t.compressedSize),await this.tokenizer.readBuffer(i),await this.inflate(t,i,r.handler)):(R(`Ignoring compressed-file-data: ${t.compressedSize} bytes`),await this.tokenizer.ignore(t.compressedSize));if(R(`Reading data-descriptor at pos=${this.tokenizer.position}`),t.dataDescriptor&&(await this.tokenizer.readToken(I)).signature!==134695760)throw Error(`Expected data-descriptor-signature at position ${this.tokenizer.position-I.len}`)}while(!n)}async iterateOverCentralDirectory(e,t){for(let n of e){let e=t(n);if(e.handler){this.tokenizer.setPosition(n.relativeOffsetOfLocalHeader);let t=await this.readLocalFileHeader();if(t){await this.tokenizer.ignore(t.extraFieldLength);let r=new Uint8Array(n.compressedSize);await this.tokenizer.readBuffer(r),await this.inflate(t,r,e.handler)}}if(e.stop)break}}async inflate(t,n,r){if(t.compressedMethod===0)return r(n);if(t.compressedMethod!==8)throw Error(`Unsupported ZIP compression method: ${t.compressedMethod}`);return R(`Decompress filename=${t.filename}, compressed-size=${n.length}`),r(await e.decompressDeflateRaw(n))}static async decompressDeflateRaw(e){let t=new ReadableStream({start(t){t.enqueue(e),t.close()}}),n=new DecompressionStream(`deflate-raw`),r=t.pipeThrough(n);try{let e=await new Response(r).arrayBuffer();return new Uint8Array(e)}catch(e){let t=e instanceof Error?`Failed to deflate ZIP entry: ${e.message}`:`Unknown decompression error in ZIP entry`;throw TypeError(t)}}async readLocalFileHeader(){let e=await this.tokenizer.peekToken(d);if(e===F.LocalFileHeader){let e=await this.tokenizer.readToken(ae);return e.filename=await this.tokenizer.readToken(new h(e.filenameLength,`utf-8`)),e}if(e===F.CentralFileHeader)return!1;throw e===3759263696?Error(`Encrypted ZIP`):Error(`Unexpected signature`)}};function ue(e,t){let n=e.length,r=t.length;if(r>n)return-1;for(let i=0;i<=n-r;i++){let n=!0;for(let a=0;a<r;a++)if(e[i+a]!==t[a]){n=!1;break}if(n)return i}return-1}function de(e){let t=e.reduce((e,t)=>e+t.length,0),n=new Uint8Array(t),r=0;for(let t of e)n.set(t,r),r+=t.length;return n}var fe=class{constructor(e){this.tokenizer=e}inflate(){let e=this.tokenizer;return new ReadableStream({async pull(t){let n=new Uint8Array(1024),r=await e.readBuffer(n,{mayBeLess:!0});if(r===0){t.close();return}t.enqueue(n.subarray(0,r))}}).pipeThrough(new DecompressionStream(`gzip`))}};function pe(e,t){if(t===`utf-16le`){let t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);t.push(r&255,r>>8&255)}return t}if(t===`utf-16be`){let t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);t.push(r>>8&255,r&255)}return t}return[...e].map(e=>e.charCodeAt(0))}function me(e,t=0){let n=Number.parseInt(new h(6).get(e,148).replace(/\0.*$/,``).trim(),8);if(Number.isNaN(n))return!1;let r=256;for(let n=t;n<t+148;n++)r+=e[n];for(let n=t+156;n<t+512;n++)r+=e[n];return n===r}const he={get:(e,t)=>e[t+3]&127|e[t+2]<<7|e[t+1]<<14|e[t]<<21,len:4},V=4100;async function H(e,t){return new ge(t).fromBuffer(e)}function U(e){switch(e=e.toLowerCase(),e){case`application/epub+zip`:return{ext:`epub`,mime:e};case`application/vnd.oasis.opendocument.text`:return{ext:`odt`,mime:e};case`application/vnd.oasis.opendocument.text-template`:return{ext:`ott`,mime:e};case`application/vnd.oasis.opendocument.spreadsheet`:return{ext:`ods`,mime:e};case`application/vnd.oasis.opendocument.spreadsheet-template`:return{ext:`ots`,mime:e};case`application/vnd.oasis.opendocument.presentation`:return{ext:`odp`,mime:e};case`application/vnd.oasis.opendocument.presentation-template`:return{ext:`otp`,mime:e};case`application/vnd.oasis.opendocument.graphics`:return{ext:`odg`,mime:e};case`application/vnd.oasis.opendocument.graphics-template`:return{ext:`otg`,mime:e};case`application/vnd.openxmlformats-officedocument.presentationml.slideshow`:return{ext:`ppsx`,mime:e};case`application/vnd.openxmlformats-officedocument.spreadsheetml.sheet`:return{ext:`xlsx`,mime:e};case`application/vnd.ms-excel.sheet.macroenabled`:return{ext:`xlsm`,mime:`application/vnd.ms-excel.sheet.macroenabled.12`};case`application/vnd.openxmlformats-officedocument.spreadsheetml.template`:return{ext:`xltx`,mime:e};case`application/vnd.ms-excel.template.macroenabled`:return{ext:`xltm`,mime:`application/vnd.ms-excel.template.macroenabled.12`};case`application/vnd.ms-powerpoint.slideshow.macroenabled`:return{ext:`ppsm`,mime:`application/vnd.ms-powerpoint.slideshow.macroenabled.12`};case`application/vnd.openxmlformats-officedocument.wordprocessingml.document`:return{ext:`docx`,mime:e};case`application/vnd.ms-word.document.macroenabled`:return{ext:`docm`,mime:`application/vnd.ms-word.document.macroenabled.12`};case`application/vnd.openxmlformats-officedocument.wordprocessingml.template`:return{ext:`dotx`,mime:e};case`application/vnd.ms-word.template.macroenabledtemplate`:return{ext:`dotm`,mime:`application/vnd.ms-word.template.macroenabled.12`};case`application/vnd.openxmlformats-officedocument.presentationml.template`:return{ext:`potx`,mime:e};case`application/vnd.ms-powerpoint.template.macroenabled`:return{ext:`potm`,mime:`application/vnd.ms-powerpoint.template.macroenabled.12`};case`application/vnd.openxmlformats-officedocument.presentationml.presentation`:return{ext:`pptx`,mime:e};case`application/vnd.ms-powerpoint.presentation.macroenabled`:return{ext:`pptm`,mime:`application/vnd.ms-powerpoint.presentation.macroenabled.12`};case`application/vnd.ms-visio.drawing`:return{ext:`vsdx`,mime:`application/vnd.visio`};case`application/vnd.ms-package.3dmanufacturing-3dmodel+xml`:return{ext:`3mf`,mime:`model/3mf`};default:}}function W(e,t,n){n={offset:0,...n};for(let[r,i]of t.entries())if(n.mask){if(i!==(n.mask[r]&e[r+n.offset]))return!1}else if(i!==e[r+n.offset])return!1;return!0}var ge=class{constructor(e){this.options={mpegOffsetTolerance:0,...e},this.detectors=[...e?.customDetectors??[],{id:`core`,detect:this.detectConfident},{id:`core.imprecise`,detect:this.detectImprecise}],this.tokenizerOptions={abortSignal:e?.signal}}async fromTokenizer(e){let t=e.position;for(let n of this.detectors){let r=await n.detect(e);if(r)return r;if(t!==e.position)return}}async fromBuffer(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer))throw TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`ArrayBuffer\`, got \`${typeof e}\``);let t=e instanceof Uint8Array?e:new Uint8Array(e);if(t?.length>1)return this.fromTokenizer(w(t,this.tokenizerOptions))}async fromBlob(e){let t=E(e,this.tokenizerOptions);try{return await this.fromTokenizer(t)}finally{await t.close()}}async fromStream(e){let t=T(e,this.tokenizerOptions);try{return await this.fromTokenizer(t)}finally{await t.close()}}async toDetectionStream(e,t){let{sampleSize:n=V}=t,r,i,a=e.getReader({mode:`byob`});try{let{value:e,done:t}=await a.read(new Uint8Array(n));if(i=e,!t&&e)try{r=await this.fromBuffer(e.subarray(0,n))}catch(e){if(!(e instanceof C))throw e;r=void 0}i=e}finally{a.releaseLock()}let o=new TransformStream({async start(e){e.enqueue(i)},transform(e,t){t.enqueue(e)}}),s=e.pipeThrough(o);return s.fileType=r,s}check(e,t){return W(this.buffer,e,t)}checkString(e,t){return this.check(pe(e,t?.encoding),t)}detectConfident=async e=>{if(this.buffer=new Uint8Array(V),e.fileInfo.size===void 0&&(e.fileInfo.size=2**53-1),this.tokenizer=e,await e.peekBuffer(this.buffer,{length:32,mayBeLess:!0}),this.check([66,77]))return{ext:`bmp`,mime:`image/bmp`};if(this.check([11,119]))return{ext:`ac3`,mime:`audio/vnd.dolby.dd-raw`};if(this.check([120,1]))return{ext:`dmg`,mime:`application/x-apple-diskimage`};if(this.check([77,90]))return{ext:`exe`,mime:`application/x-msdownload`};if(this.check([37,33]))return await e.peekBuffer(this.buffer,{length:24,mayBeLess:!0}),this.checkString(`PS-Adobe-`,{offset:2})&&this.checkString(` EPSF-`,{offset:14})?{ext:`eps`,mime:`application/eps`}:{ext:`ps`,mime:`application/postscript`};if(this.check([31,160])||this.check([31,157]))return{ext:`Z`,mime:`application/x-compress`};if(this.check([199,113]))return{ext:`cpio`,mime:`application/x-cpio`};if(this.check([96,234]))return{ext:`arj`,mime:`application/x-arj`};if(this.check([239,187,191]))return this.tokenizer.ignore(3),this.detectConfident(e);if(this.check([71,73,70]))return{ext:`gif`,mime:`image/gif`};if(this.check([73,73,188]))return{ext:`jxr`,mime:`image/vnd.ms-photo`};if(this.check([31,139,8])){let t=new fe(e).inflate(),n=!0;try{let e;try{e=await this.fromStream(t)}catch{n=!1}if(e&&e.ext===`tar`)return{ext:`tar.gz`,mime:`application/gzip`}}finally{n&&await t.cancel()}return{ext:`gz`,mime:`application/gzip`}}if(this.check([66,90,104]))return{ext:`bz2`,mime:`application/x-bzip2`};if(this.checkString(`ID3`)){await e.ignore(6);let t=await e.readToken(he);return e.position+t>e.fileInfo.size?{ext:`mp3`,mime:`audio/mpeg`}:(await e.ignore(t),this.fromTokenizer(e))}if(this.checkString(`MP+`))return{ext:`mpc`,mime:`audio/x-musepack`};if((this.buffer[0]===67||this.buffer[0]===70)&&this.check([87,83],{offset:1}))return{ext:`swf`,mime:`application/x-shockwave-flash`};if(this.check([255,216,255]))return this.check([247],{offset:3})?{ext:`jls`,mime:`image/jls`}:{ext:`jpg`,mime:`image/jpeg`};if(this.check([79,98,106,1]))return{ext:`avro`,mime:`application/avro`};if(this.checkString(`FLIF`))return{ext:`flif`,mime:`image/flif`};if(this.checkString(`8BPS`))return{ext:`psd`,mime:`image/vnd.adobe.photoshop`};if(this.checkString(`MPCK`))return{ext:`mpc`,mime:`audio/x-musepack`};if(this.checkString(`FORM`))return{ext:`aif`,mime:`audio/aiff`};if(this.checkString(`icns`,{offset:0}))return{ext:`icns`,mime:`image/icns`};if(this.check([80,75,3,4])){let t;return await new le(e).unzip(e=>{switch(e.filename){case`META-INF/mozilla.rsa`:return t={ext:`xpi`,mime:`application/x-xpinstall`},{stop:!0};case`META-INF/MANIFEST.MF`:return t={ext:`jar`,mime:`application/java-archive`},{stop:!0};case`mimetype`:return{async handler(e){t=U(new TextDecoder(`utf-8`).decode(e).trim())},stop:!0};case`[Content_Types].xml`:return{async handler(e){let n=new TextDecoder(`utf-8`).decode(e),r=n.indexOf(`.main+xml"`);if(r===-1){let e=`application/vnd.ms-package.3dmanufacturing-3dmodel+xml`;n.includes(`ContentType="${e}"`)&&(t=U(e))}else{n=n.slice(0,Math.max(0,r));let e=n.lastIndexOf(`"`);t=U(n.slice(Math.max(0,e+1)))}},stop:!0};default:return/classes\d*\.dex/.test(e.filename)?(t={ext:`apk`,mime:`application/vnd.android.package-archive`},{stop:!0}):{}}}).catch(e=>{if(!(e instanceof C))throw e}),t??{ext:`zip`,mime:`application/zip`}}if(this.checkString(`OggS`)){await e.ignore(28);let t=new Uint8Array(8);return await e.readBuffer(t),W(t,[79,112,117,115,72,101,97,100])?{ext:`opus`,mime:`audio/ogg; codecs=opus`}:W(t,[128,116,104,101,111,114,97])?{ext:`ogv`,mime:`video/ogg`}:W(t,[1,118,105,100,101,111,0])?{ext:`ogm`,mime:`video/ogg`}:W(t,[127,70,76,65,67])?{ext:`oga`,mime:`audio/ogg`}:W(t,[83,112,101,101,120,32,32])?{ext:`spx`,mime:`audio/ogg`}:W(t,[1,118,111,114,98,105,115])?{ext:`ogg`,mime:`audio/ogg`}:{ext:`ogx`,mime:`application/ogg`}}if(this.check([80,75])&&(this.buffer[2]===3||this.buffer[2]===5||this.buffer[2]===7)&&(this.buffer[3]===4||this.buffer[3]===6||this.buffer[3]===8))return{ext:`zip`,mime:`application/zip`};if(this.checkString(`MThd`))return{ext:`mid`,mime:`audio/midi`};if(this.checkString(`wOFF`)&&(this.check([0,1,0,0],{offset:4})||this.checkString(`OTTO`,{offset:4})))return{ext:`woff`,mime:`font/woff`};if(this.checkString(`wOF2`)&&(this.check([0,1,0,0],{offset:4})||this.checkString(`OTTO`,{offset:4})))return{ext:`woff2`,mime:`font/woff2`};if(this.check([212,195,178,161])||this.check([161,178,195,212]))return{ext:`pcap`,mime:`application/vnd.tcpdump.pcap`};if(this.checkString(`DSD `))return{ext:`dsf`,mime:`audio/x-dsf`};if(this.checkString(`LZIP`))return{ext:`lz`,mime:`application/x-lzip`};if(this.checkString(`fLaC`))return{ext:`flac`,mime:`audio/flac`};if(this.check([66,80,71,251]))return{ext:`bpg`,mime:`image/bpg`};if(this.checkString(`wvpk`))return{ext:`wv`,mime:`audio/wavpack`};if(this.checkString(`%PDF`))return{ext:`pdf`,mime:`application/pdf`};if(this.check([0,97,115,109]))return{ext:`wasm`,mime:`application/wasm`};if(this.check([73,73])){let e=await this.readTiffHeader(!1);if(e)return e}if(this.check([77,77])){let e=await this.readTiffHeader(!0);if(e)return e}if(this.checkString(`MAC `))return{ext:`ape`,mime:`audio/ape`};if(this.check([26,69,223,163])){async function t(){let t=await e.peekNumber(f),n=128,r=0;for(;(t&n)===0&&n!==0;)++r,n>>=1;let i=new Uint8Array(r+1);return await e.readBuffer(i),i}async function n(){let e=await t(),n=await t();n[0]^=128>>n.length-1;let r=Math.min(6,n.length),i=new DataView(e.buffer),a=new DataView(n.buffer,n.length-r,r);return{id:D(i),len:D(a)}}async function r(t){for(;t>0;){let r=await n();if(r.id===17026)return(await e.readToken(new h(r.len))).replaceAll(/\00.*$/g,``);await e.ignore(r.len),--t}}switch(await r((await n()).len)){case`webm`:return{ext:`webm`,mime:`video/webm`};case`matroska`:return{ext:`mkv`,mime:`video/matroska`};default:return}}if(this.checkString(`SQLi`))return{ext:`sqlite`,mime:`application/x-sqlite3`};if(this.check([78,69,83,26]))return{ext:`nes`,mime:`application/x-nintendo-nes-rom`};if(this.checkString(`Cr24`))return{ext:`crx`,mime:`application/x-google-chrome-extension`};if(this.checkString(`MSCF`)||this.checkString(`ISc(`))return{ext:`cab`,mime:`application/vnd.ms-cab-compressed`};if(this.check([237,171,238,219]))return{ext:`rpm`,mime:`application/x-rpm`};if(this.check([197,208,211,198]))return{ext:`eps`,mime:`application/eps`};if(this.check([40,181,47,253]))return{ext:`zst`,mime:`application/zstd`};if(this.check([127,69,76,70]))return{ext:`elf`,mime:`application/x-elf`};if(this.check([33,66,68,78]))return{ext:`pst`,mime:`application/vnd.ms-outlook`};if(this.checkString(`PAR1`)||this.checkString(`PARE`))return{ext:`parquet`,mime:`application/vnd.apache.parquet`};if(this.checkString(`ttcf`))return{ext:`ttc`,mime:`font/collection`};if(this.check([254,237,250,206])||this.check([254,237,250,207])||this.check([206,250,237,254])||this.check([207,250,237,254]))return{ext:`macho`,mime:`application/x-mach-binary`};if(this.check([4,34,77,24]))return{ext:`lz4`,mime:`application/x-lz4`};if(this.checkString(`regf`))return{ext:`dat`,mime:`application/x-ft-windows-registry-hive`};if(this.checkString(`$FL2`)||this.checkString(`$FL3`))return{ext:`sav`,mime:`application/x-spss-sav`};if(this.check([79,84,84,79,0]))return{ext:`otf`,mime:`font/otf`};if(this.checkString(`#!AMR`))return{ext:`amr`,mime:`audio/amr`};if(this.checkString(`{\\rtf`))return{ext:`rtf`,mime:`application/rtf`};if(this.check([70,76,86,1]))return{ext:`flv`,mime:`video/x-flv`};if(this.checkString(`IMPM`))return{ext:`it`,mime:`audio/x-it`};if(this.checkString(`-lh0-`,{offset:2})||this.checkString(`-lh1-`,{offset:2})||this.checkString(`-lh2-`,{offset:2})||this.checkString(`-lh3-`,{offset:2})||this.checkString(`-lh4-`,{offset:2})||this.checkString(`-lh5-`,{offset:2})||this.checkString(`-lh6-`,{offset:2})||this.checkString(`-lh7-`,{offset:2})||this.checkString(`-lzs-`,{offset:2})||this.checkString(`-lz4-`,{offset:2})||this.checkString(`-lz5-`,{offset:2})||this.checkString(`-lhd-`,{offset:2}))return{ext:`lzh`,mime:`application/x-lzh-compressed`};if(this.check([0,0,1,186])){if(this.check([33],{offset:4,mask:[241]}))return{ext:`mpg`,mime:`video/MP1S`};if(this.check([68],{offset:4,mask:[196]}))return{ext:`mpg`,mime:`video/MP2P`}}if(this.checkString(`ITSF`))return{ext:`chm`,mime:`application/vnd.ms-htmlhelp`};if(this.check([202,254,186,190])){let e=p.get(this.buffer,4),t=x.get(this.buffer,6);if(e>0&&e<=30)return{ext:`macho`,mime:`application/x-mach-binary`};if(t>30)return{ext:`class`,mime:`application/java-vm`}}if(this.checkString(`.RMF`))return{ext:`rm`,mime:`application/vnd.rn-realmedia`};if(this.checkString(`DRACO`))return{ext:`drc`,mime:`application/vnd.google.draco`};if(this.check([253,55,122,88,90,0]))return{ext:`xz`,mime:`application/x-xz`};if(this.checkString(`<?xml `))return{ext:`xml`,mime:`application/xml`};if(this.check([55,122,188,175,39,28]))return{ext:`7z`,mime:`application/x-7z-compressed`};if(this.check([82,97,114,33,26,7])&&(this.buffer[6]===0||this.buffer[6]===1))return{ext:`rar`,mime:`application/x-rar-compressed`};if(this.checkString(`solid `))return{ext:`stl`,mime:`model/stl`};if(this.checkString(`AC`)){let e=new h(4,`latin1`).get(this.buffer,2);if(e.match(`^d*`)&&e>=1e3&&e<=1050)return{ext:`dwg`,mime:`image/vnd.dwg`}}if(this.checkString(`070707`))return{ext:`cpio`,mime:`application/x-cpio`};if(this.checkString(`BLENDER`))return{ext:`blend`,mime:`application/x-blender`};if(this.checkString(`!<arch>`))return await e.ignore(8),await e.readToken(new h(13,`ascii`))===`debian-binary`?{ext:`deb`,mime:`application/x-deb`}:{ext:`ar`,mime:`application/x-unix-archive`};if(this.checkString(`WEBVTT`)&&[`
`,`\r`,`	`,` `,`\0`].some(e=>this.checkString(e,{offset:6})))return{ext:`vtt`,mime:`text/vtt`};if(this.check([137,80,78,71,13,10,26,10])){await e.ignore(8);async function t(){return{length:await e.readToken(_),type:await e.readToken(new h(4,`latin1`))}}do{let n=await t();if(n.length<0)return;switch(n.type){case`IDAT`:return{ext:`png`,mime:`image/png`};case`acTL`:return{ext:`apng`,mime:`image/apng`};default:await e.ignore(n.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:`png`,mime:`image/png`}}if(this.check([65,82,82,79,87,49,0,0]))return{ext:`arrow`,mime:`application/vnd.apache.arrow.file`};if(this.check([103,108,84,70,2,0,0,0]))return{ext:`glb`,mime:`model/gltf-binary`};if(this.check([102,114,101,101],{offset:4})||this.check([109,100,97,116],{offset:4})||this.check([109,111,111,118],{offset:4})||this.check([119,105,100,101],{offset:4}))return{ext:`mov`,mime:`video/quicktime`};if(this.check([73,73,82,79,8,0,0,0,24]))return{ext:`orf`,mime:`image/x-olympus-orf`};if(this.checkString(`gimp xcf `))return{ext:`xcf`,mime:`image/x-xcf`};if(this.checkString(`ftyp`,{offset:4})&&this.buffer[8]&96){let e=new h(4,`latin1`).get(this.buffer,8).replace(`\0`,` `).trim();switch(e){case`avif`:case`avis`:return{ext:`avif`,mime:`image/avif`};case`mif1`:return{ext:`heic`,mime:`image/heif`};case`msf1`:return{ext:`heic`,mime:`image/heif-sequence`};case`heic`:case`heix`:return{ext:`heic`,mime:`image/heic`};case`hevc`:case`hevx`:return{ext:`heic`,mime:`image/heic-sequence`};case`qt`:return{ext:`mov`,mime:`video/quicktime`};case`M4V`:case`M4VH`:case`M4VP`:return{ext:`m4v`,mime:`video/x-m4v`};case`M4P`:return{ext:`m4p`,mime:`video/mp4`};case`M4B`:return{ext:`m4b`,mime:`audio/mp4`};case`M4A`:return{ext:`m4a`,mime:`audio/x-m4a`};case`F4V`:return{ext:`f4v`,mime:`video/mp4`};case`F4P`:return{ext:`f4p`,mime:`video/mp4`};case`F4A`:return{ext:`f4a`,mime:`audio/mp4`};case`F4B`:return{ext:`f4b`,mime:`audio/mp4`};case`crx`:return{ext:`cr3`,mime:`image/x-canon-cr3`};default:return e.startsWith(`3g`)?e.startsWith(`3g2`)?{ext:`3g2`,mime:`video/3gpp2`}:{ext:`3gp`,mime:`video/3gpp`}:{ext:`mp4`,mime:`video/mp4`}}}if(this.checkString(`REGEDIT4\r
`))return{ext:`reg`,mime:`application/x-ms-regedit`};if(this.check([82,73,70,70])){if(this.checkString(`WEBP`,{offset:8}))return{ext:`webp`,mime:`image/webp`};if(this.check([65,86,73],{offset:8}))return{ext:`avi`,mime:`video/vnd.avi`};if(this.check([87,65,86,69],{offset:8}))return{ext:`wav`,mime:`audio/wav`};if(this.check([81,76,67,77],{offset:8}))return{ext:`qcp`,mime:`audio/qcelp`}}if(this.check([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:`rw2`,mime:`image/x-panasonic-rw2`};if(this.check([48,38,178,117,142,102,207,17,166,217])){async function t(){let t=new Uint8Array(16);return await e.readBuffer(t),{id:t,size:Number(await e.readToken(m))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){let n=await t(),r=n.size-24;if(W(n.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){let t=new Uint8Array(16);if(r-=await e.readBuffer(t),W(t,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:`asf`,mime:`audio/x-ms-asf`};if(W(t,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:`asf`,mime:`video/x-ms-asf`};break}await e.ignore(r)}return{ext:`asf`,mime:`application/vnd.ms-asf`}}if(this.check([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:`ktx`,mime:`image/ktx`};if((this.check([126,16,4])||this.check([126,24,4]))&&this.check([48,77,73,69],{offset:4}))return{ext:`mie`,mime:`application/x-mie`};if(this.check([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:`shp`,mime:`application/x-esri-shape`};if(this.check([255,79,255,81]))return{ext:`j2c`,mime:`image/j2c`};if(this.check([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await e.ignore(20),await e.readToken(new h(4,`ascii`))){case`jp2 `:return{ext:`jp2`,mime:`image/jp2`};case`jpx `:return{ext:`jpx`,mime:`image/jpx`};case`jpm `:return{ext:`jpm`,mime:`image/jpm`};case`mjp2`:return{ext:`mj2`,mime:`image/mj2`};default:return}if(this.check([255,10])||this.check([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:`jxl`,mime:`image/jxl`};if(this.check([254,255]))return this.checkString(`<?xml `,{offset:2,encoding:`utf-16be`})?{ext:`xml`,mime:`application/xml`}:void 0;if(this.check([208,207,17,224,161,177,26,225]))return{ext:`cfb`,mime:`application/x-cfb`};if(await e.peekBuffer(this.buffer,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),this.check([97,99,115,112],{offset:36}))return{ext:`icc`,mime:`application/vnd.iccprofile`};if(this.checkString(`**ACE`,{offset:7})&&this.checkString(`**`,{offset:12}))return{ext:`ace`,mime:`application/x-ace-compressed`};if(this.checkString(`BEGIN:`)){if(this.checkString(`VCARD`,{offset:6}))return{ext:`vcf`,mime:`text/vcard`};if(this.checkString(`VCALENDAR`,{offset:6}))return{ext:`ics`,mime:`text/calendar`}}if(this.checkString(`FUJIFILMCCD-RAW`))return{ext:`raf`,mime:`image/x-fujifilm-raf`};if(this.checkString(`Extended Module:`))return{ext:`xm`,mime:`audio/x-xm`};if(this.checkString(`Creative Voice File`))return{ext:`voc`,mime:`audio/x-voc`};if(this.check([4,0,0,0])&&this.buffer.length>=16){let e=new DataView(this.buffer.buffer).getUint32(12,!0);if(e>12&&this.buffer.length>=e+16)try{let t=new TextDecoder().decode(this.buffer.subarray(16,e+16));if(JSON.parse(t).files)return{ext:`asar`,mime:`application/x-asar`}}catch{}}if(this.check([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:`mxf`,mime:`application/mxf`};if(this.checkString(`SCRM`,{offset:44}))return{ext:`s3m`,mime:`audio/x-s3m`};if(this.check([71])&&this.check([71],{offset:188})||this.check([71],{offset:4})&&this.check([71],{offset:196}))return{ext:`mts`,mime:`video/mp2t`};if(this.check([66,79,79,75,77,79,66,73],{offset:60}))return{ext:`mobi`,mime:`application/x-mobipocket-ebook`};if(this.check([68,73,67,77],{offset:128}))return{ext:`dcm`,mime:`application/dicom`};if(this.check([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:`lnk`,mime:`application/x.ms.shortcut`};if(this.check([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:`alias`,mime:`application/x.apple.alias`};if(this.checkString(`Kaydara FBX Binary  \0`))return{ext:`fbx`,mime:`application/x.autodesk.fbx`};if(this.check([76,80],{offset:34})&&(this.check([0,0,1],{offset:8})||this.check([1,0,2],{offset:8})||this.check([2,0,2],{offset:8})))return{ext:`eot`,mime:`application/vnd.ms-fontobject`};if(this.check([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:`indd`,mime:`application/x-indesign`};if(this.check([255,255,0,0,7,0,0,0,4,0,0,0,1,0,1,0])||this.check([0,0,255,255,0,0,0,7,0,0,0,4,0,1,0,1]))return{ext:`jmp`,mime:`application/x-jmp-data`};if(await e.peekBuffer(this.buffer,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),this.checkString(`ustar`,{offset:257})&&(this.checkString(`\0`,{offset:262})||this.checkString(` `,{offset:262}))||this.check([0,0,0,0,0,0],{offset:257})&&me(this.buffer))return{ext:`tar`,mime:`application/x-tar`};if(this.check([255,254])){let e=`utf-16le`;return this.checkString(`<?xml `,{offset:2,encoding:e})?{ext:`xml`,mime:`application/xml`}:this.check([255,14],{offset:2})&&this.checkString(`SketchUp Model`,{offset:4,encoding:e})?{ext:`skp`,mime:`application/vnd.sketchup.skp`}:this.checkString(`Windows Registry Editor Version 5.00\r
`,{offset:2,encoding:e})?{ext:`reg`,mime:`application/x-ms-regedit`}:void 0}if(this.checkString(`-----BEGIN PGP MESSAGE-----`))return{ext:`pgp`,mime:`application/pgp-encrypted`}};detectImprecise=async e=>{if(this.buffer=new Uint8Array(V),await e.peekBuffer(this.buffer,{length:Math.min(8,e.fileInfo.size),mayBeLess:!0}),this.check([0,0,1,186])||this.check([0,0,1,179]))return{ext:`mpg`,mime:`video/mpeg`};if(this.check([0,1,0,0,0]))return{ext:`ttf`,mime:`font/ttf`};if(this.check([0,0,1,0]))return{ext:`ico`,mime:`image/x-icon`};if(this.check([0,0,2,0]))return{ext:`cur`,mime:`image/x-icon`};if(await e.peekBuffer(this.buffer,{length:Math.min(2+this.options.mpegOffsetTolerance,e.fileInfo.size),mayBeLess:!0}),this.buffer.length>=2+this.options.mpegOffsetTolerance)for(let e=0;e<=this.options.mpegOffsetTolerance;++e){let t=this.scanMpeg(e);if(t)return t}};async readTiffTag(e){let t=await this.tokenizer.readToken(e?x:S);switch(this.tokenizer.ignore(10),t){case 50341:return{ext:`arw`,mime:`image/x-sony-arw`};case 50706:return{ext:`dng`,mime:`image/x-adobe-dng`};default:}}async readTiffIFD(e){let t=await this.tokenizer.readToken(e?x:S);for(let n=0;n<t;++n){let t=await this.readTiffTag(e);if(t)return t}}async readTiffHeader(e){let t=(e?x:S).get(this.buffer,2),n=(e?p:d).get(this.buffer,4);if(t===42){if(n>=6){if(this.checkString(`CR`,{offset:8}))return{ext:`cr2`,mime:`image/x-canon-cr2`};if(n>=8){let t=(e?x:S).get(this.buffer,8),n=(e?x:S).get(this.buffer,10);if(t===28&&n===254||t===31&&n===11)return{ext:`nef`,mime:`image/x-nikon-nef`}}}return await this.tokenizer.ignore(n),await this.readTiffIFD(e)??{ext:`tif`,mime:`image/tiff`}}if(t===43)return{ext:`tif`,mime:`image/tiff`}}scanMpeg(e){if(this.check([255,224],{offset:e,mask:[255,224]})){if(this.check([16],{offset:e+1,mask:[22]}))return this.check([8],{offset:e+1,mask:[8]}),{ext:`aac`,mime:`audio/aac`};if(this.check([2],{offset:e+1,mask:[6]}))return{ext:`mp3`,mime:`audio/mpeg`};if(this.check([4],{offset:e+1,mask:[6]}))return{ext:`mp2`,mime:`audio/mpeg`};if(this.check([6],{offset:e+1,mask:[6]}))return{ext:`mp1`,mime:`audio/mpeg`}}}},_e=s((e=>{var t=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,n=/\\([\u000b\u0020-\u00ff])/g,r=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;e.parse=i;function i(e){if(!e)throw TypeError(`argument string is required`);var i=typeof e==`object`?a(e):e;if(typeof i!=`string`)throw TypeError(`argument string is required to be a string`);var s=i.indexOf(`;`),c=s===-1?i.trim():i.slice(0,s).trim();if(!r.test(c))throw TypeError(`invalid media type`);var l=new o(c.toLowerCase());if(s!==-1){var u,d,f;for(t.lastIndex=s;d=t.exec(i);){if(d.index!==s)throw TypeError(`invalid parameter format`);s+=d[0].length,u=d[1].toLowerCase(),f=d[2],f.charCodeAt(0)===34&&(f=f.slice(1,-1),f.indexOf(`\\`)!==-1&&(f=f.replace(n,`$1`))),l.parameters[u]=f}if(s!==i.length)throw TypeError(`invalid parameter format`)}return l}function a(e){var t;if(typeof e.getHeader==`function`?t=e.getHeader(`content-type`):typeof e.headers==`object`&&(t=e.headers&&e.headers[`content-type`]),typeof t!=`string`)throw TypeError(`content-type header is missing from object`);return t}function o(e){this.parameters=Object.create(null),this.type=e}})),ve=s((e=>{var t=/^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/;e.parse=n;function n(e){if(!e)throw TypeError(`argument string is required`);if(typeof e!=`string`)throw TypeError(`argument string is required to be a string`);var n=t.exec(e.toLowerCase());if(!n)throw TypeError(`invalid media type`);var i=n[1],a=n[2],o,s=a.lastIndexOf(`+`);return s!==-1&&(o=a.substr(s+1),a=a.substr(0,s)),new r(i,a,o)}function r(e,t,n){this.type=e,this.subtype=t,this.suffix=n}}))(),ye=l(_e(),1),G={multiple:!1},K={year:G,track:G,disk:G,title:G,artist:G,artists:{multiple:!0,unique:!0},albumartist:G,album:G,date:G,originaldate:G,originalyear:G,releasedate:G,comment:{multiple:!0,unique:!1},genre:{multiple:!0,unique:!0},picture:{multiple:!0,unique:!0},composer:{multiple:!0,unique:!0},lyrics:{multiple:!0,unique:!1},albumsort:{multiple:!1,unique:!0},titlesort:{multiple:!1,unique:!0},work:{multiple:!1,unique:!0},artistsort:{multiple:!1,unique:!0},albumartistsort:{multiple:!1,unique:!0},composersort:{multiple:!1,unique:!0},lyricist:{multiple:!0,unique:!0},writer:{multiple:!0,unique:!0},conductor:{multiple:!0,unique:!0},remixer:{multiple:!0,unique:!0},arranger:{multiple:!0,unique:!0},engineer:{multiple:!0,unique:!0},producer:{multiple:!0,unique:!0},technician:{multiple:!0,unique:!0},djmixer:{multiple:!0,unique:!0},mixer:{multiple:!0,unique:!0},label:{multiple:!0,unique:!0},grouping:G,subtitle:{multiple:!0},discsubtitle:G,totaltracks:G,totaldiscs:G,compilation:G,rating:{multiple:!0},bpm:G,mood:G,media:G,catalognumber:{multiple:!0,unique:!0},tvShow:G,tvShowSort:G,tvSeason:G,tvEpisode:G,tvEpisodeId:G,tvNetwork:G,podcast:G,podcasturl:G,releasestatus:G,releasetype:{multiple:!0},releasecountry:G,script:G,language:G,copyright:G,license:G,encodedby:G,encodersettings:G,gapless:G,barcode:G,isrc:{multiple:!0},asin:G,musicbrainz_recordingid:G,musicbrainz_trackid:G,musicbrainz_albumid:G,musicbrainz_artistid:{multiple:!0},musicbrainz_albumartistid:{multiple:!0},musicbrainz_releasegroupid:G,musicbrainz_workid:G,musicbrainz_trmid:G,musicbrainz_discid:G,acoustid_id:G,acoustid_fingerprint:G,musicip_puid:G,musicip_fingerprint:G,website:G,"performer:instrument":{multiple:!0,unique:!0},averageLevel:G,peakLevel:G,notes:{multiple:!0,unique:!1},key:G,originalalbum:G,originalartist:G,discogs_artist_id:{multiple:!0,unique:!0},discogs_release_id:G,discogs_label_id:G,discogs_master_release_id:G,discogs_votes:G,discogs_rating:G,replaygain_track_peak:G,replaygain_track_gain:G,replaygain_album_peak:G,replaygain_album_gain:G,replaygain_track_minmax:G,replaygain_album_minmax:G,replaygain_undo:G,description:{multiple:!0},longDescription:G,category:{multiple:!0},hdVideo:G,keywords:{multiple:!0},movement:G,movementIndex:G,movementTotal:G,podcastId:G,showMovement:G,stik:G,playCounter:G};function be(e){return K[e]&&!K[e].multiple}function xe(e){return!K[e].multiple||K[e].unique||!1}var q=class{static toIntOrNull(e){let t=Number.parseInt(e,10);return Number.isNaN(t)?null:t}static normalizeTrack(e){let t=e.toString().split(`/`);return{no:Number.parseInt(t[0],10)||null,of:Number.parseInt(t[1],10)||null}}constructor(e,t){this.tagTypes=e,this.tagMap=t}mapGenericTag(e,t){e={id:e.id,value:e.value},this.postMap(e,t);let n=this.getCommonName(e.id);return n?{id:n,value:e.value}:null}getCommonName(e){return this.tagMap[e]}postMap(e,t){}};q.maxRatingScore=1;var Se={title:`title`,artist:`artist`,album:`album`,year:`year`,comment:`comment`,track:`track`,genre:`genre`},Ce=class extends q{constructor(){super([`ID3v1`],Se)}},J=class extends q{constructor(e,t){let n={};for(let e of Object.keys(t))n[e.toUpperCase()]=t[e];super(e,n)}getCommonName(e){return this.tagMap[e.toUpperCase()]}},we={TIT2:`title`,TPE1:`artist`,"TXXX:Artists":`artists`,TPE2:`albumartist`,TALB:`album`,TDRV:`date`,TORY:`originalyear`,TPOS:`disk`,TCON:`genre`,APIC:`picture`,TCOM:`composer`,USLT:`lyrics`,TSOA:`albumsort`,TSOT:`titlesort`,TOAL:`originalalbum`,TSOP:`artistsort`,TSO2:`albumartistsort`,TSOC:`composersort`,TEXT:`lyricist`,"TXXX:Writer":`writer`,TPE3:`conductor`,TPE4:`remixer`,"IPLS:arranger":`arranger`,"IPLS:engineer":`engineer`,"IPLS:producer":`producer`,"IPLS:DJ-mix":`djmixer`,"IPLS:mix":`mixer`,TPUB:`label`,TIT1:`grouping`,TIT3:`subtitle`,TRCK:`track`,TCMP:`compilation`,POPM:`rating`,TBPM:`bpm`,TMED:`media`,"TXXX:CATALOGNUMBER":`catalognumber`,"TXXX:MusicBrainz Album Status":`releasestatus`,"TXXX:MusicBrainz Album Type":`releasetype`,"TXXX:MusicBrainz Album Release Country":`releasecountry`,"TXXX:RELEASECOUNTRY":`releasecountry`,"TXXX:SCRIPT":`script`,TLAN:`language`,TCOP:`copyright`,WCOP:`license`,TENC:`encodedby`,TSSE:`encodersettings`,"TXXX:BARCODE":`barcode`,"TXXX:ISRC":`isrc`,TSRC:`isrc`,"TXXX:ASIN":`asin`,"TXXX:originalyear":`originalyear`,"UFID:http://musicbrainz.org":`musicbrainz_recordingid`,"TXXX:MusicBrainz Release Track Id":`musicbrainz_trackid`,"TXXX:MusicBrainz Album Id":`musicbrainz_albumid`,"TXXX:MusicBrainz Artist Id":`musicbrainz_artistid`,"TXXX:MusicBrainz Album Artist Id":`musicbrainz_albumartistid`,"TXXX:MusicBrainz Release Group Id":`musicbrainz_releasegroupid`,"TXXX:MusicBrainz Work Id":`musicbrainz_workid`,"TXXX:MusicBrainz TRM Id":`musicbrainz_trmid`,"TXXX:MusicBrainz Disc Id":`musicbrainz_discid`,"TXXX:ACOUSTID_ID":`acoustid_id`,"TXXX:Acoustid Id":`acoustid_id`,"TXXX:Acoustid Fingerprint":`acoustid_fingerprint`,"TXXX:MusicIP PUID":`musicip_puid`,"TXXX:MusicMagic Fingerprint":`musicip_fingerprint`,WOAR:`website`,TDRC:`date`,TYER:`year`,TDOR:`originaldate`,"TIPL:arranger":`arranger`,"TIPL:engineer":`engineer`,"TIPL:producer":`producer`,"TIPL:DJ-mix":`djmixer`,"TIPL:mix":`mixer`,TMOO:`mood`,SYLT:`lyrics`,TSST:`discsubtitle`,TKEY:`key`,COMM:`comment`,TOPE:`originalartist`,"PRIV:AverageLevel":`averageLevel`,"PRIV:PeakLevel":`peakLevel`,"TXXX:DISCOGS_ARTIST_ID":`discogs_artist_id`,"TXXX:DISCOGS_ARTISTS":`artists`,"TXXX:DISCOGS_ARTIST_NAME":`artists`,"TXXX:DISCOGS_ALBUM_ARTISTS":`albumartist`,"TXXX:DISCOGS_CATALOG":`catalognumber`,"TXXX:DISCOGS_COUNTRY":`releasecountry`,"TXXX:DISCOGS_DATE":`originaldate`,"TXXX:DISCOGS_LABEL":`label`,"TXXX:DISCOGS_LABEL_ID":`discogs_label_id`,"TXXX:DISCOGS_MASTER_RELEASE_ID":`discogs_master_release_id`,"TXXX:DISCOGS_RATING":`discogs_rating`,"TXXX:DISCOGS_RELEASED":`date`,"TXXX:DISCOGS_RELEASE_ID":`discogs_release_id`,"TXXX:DISCOGS_VOTES":`discogs_votes`,"TXXX:CATALOGID":`catalognumber`,"TXXX:STYLE":`genre`,"TXXX:REPLAYGAIN_TRACK_PEAK":`replaygain_track_peak`,"TXXX:REPLAYGAIN_TRACK_GAIN":`replaygain_track_gain`,"TXXX:REPLAYGAIN_ALBUM_PEAK":`replaygain_album_peak`,"TXXX:REPLAYGAIN_ALBUM_GAIN":`replaygain_album_gain`,"TXXX:MP3GAIN_MINMAX":`replaygain_track_minmax`,"TXXX:MP3GAIN_ALBUM_MINMAX":`replaygain_album_minmax`,"TXXX:MP3GAIN_UNDO":`replaygain_undo`,MVNM:`movement`,MVIN:`movementIndex`,PCST:`podcast`,TCAT:`category`,TDES:`description`,TDRL:`releasedate`,TGID:`podcastId`,TKWD:`keywords`,WFED:`podcasturl`,GRP1:`grouping`,PCNT:`playCounter`},Te=class e extends J{static toRating(e){return{source:e.email,rating:e.rating>0?(e.rating-1)/254*q.maxRatingScore:void 0}}constructor(){super([`ID3v2.3`,`ID3v2.4`],we)}postMap(t,n){switch(t.id){case`UFID`:{let e=t.value;e.owner_identifier===`http://musicbrainz.org`&&(t.id+=`:${e.owner_identifier}`,t.value=k(e.identifier,`latin1`))}break;case`PRIV`:{let e=t.value;switch(e.owner_identifier){case`AverageLevel`:case`PeakValue`:t.id+=`:${e.owner_identifier}`,t.value=e.data.length===4?d.get(e.data,0):null,t.value===null&&n.addWarning(`Failed to parse PRIV:PeakValue`);break;default:n.addWarning(`Unknown PRIV owner-identifier: ${e.data}`)}}break;case`POPM`:t.value=e.toRating(t.value);break;default:break}}},Ee={Title:`title`,Author:`artist`,"WM/AlbumArtist":`albumartist`,"WM/AlbumTitle":`album`,"WM/Year":`date`,"WM/OriginalReleaseTime":`originaldate`,"WM/OriginalReleaseYear":`originalyear`,Description:`comment`,"WM/TrackNumber":`track`,"WM/PartOfSet":`disk`,"WM/Genre":`genre`,"WM/Composer":`composer`,"WM/Lyrics":`lyrics`,"WM/AlbumSortOrder":`albumsort`,"WM/TitleSortOrder":`titlesort`,"WM/ArtistSortOrder":`artistsort`,"WM/AlbumArtistSortOrder":`albumartistsort`,"WM/ComposerSortOrder":`composersort`,"WM/Writer":`lyricist`,"WM/Conductor":`conductor`,"WM/ModifiedBy":`remixer`,"WM/Engineer":`engineer`,"WM/Producer":`producer`,"WM/DJMixer":`djmixer`,"WM/Mixer":`mixer`,"WM/Publisher":`label`,"WM/ContentGroupDescription":`grouping`,"WM/SubTitle":`subtitle`,"WM/SetSubTitle":`discsubtitle`,"WM/IsCompilation":`compilation`,"WM/SharedUserRating":`rating`,"WM/BeatsPerMinute":`bpm`,"WM/Mood":`mood`,"WM/Media":`media`,"WM/CatalogNo":`catalognumber`,"MusicBrainz/Album Status":`releasestatus`,"MusicBrainz/Album Type":`releasetype`,"MusicBrainz/Album Release Country":`releasecountry`,"WM/Script":`script`,"WM/Language":`language`,Copyright:`copyright`,LICENSE:`license`,"WM/EncodedBy":`encodedby`,"WM/EncodingSettings":`encodersettings`,"WM/Barcode":`barcode`,"WM/ISRC":`isrc`,"MusicBrainz/Track Id":`musicbrainz_recordingid`,"MusicBrainz/Release Track Id":`musicbrainz_trackid`,"MusicBrainz/Album Id":`musicbrainz_albumid`,"MusicBrainz/Artist Id":`musicbrainz_artistid`,"MusicBrainz/Album Artist Id":`musicbrainz_albumartistid`,"MusicBrainz/Release Group Id":`musicbrainz_releasegroupid`,"MusicBrainz/Work Id":`musicbrainz_workid`,"MusicBrainz/TRM Id":`musicbrainz_trmid`,"MusicBrainz/Disc Id":`musicbrainz_discid`,"Acoustid/Id":`acoustid_id`,"Acoustid/Fingerprint":`acoustid_fingerprint`,"MusicIP/PUID":`musicip_puid`,"WM/ARTISTS":`artists`,"WM/InitialKey":`key`,ASIN:`asin`,"WM/Work":`work`,"WM/AuthorURL":`website`,"WM/Picture":`picture`},De=class e extends q{static toRating(e){return{rating:Number.parseFloat(e+1)/5}}constructor(){super([`asf`],Ee)}postMap(t){switch(t.id){case`WM/SharedUserRating`:{let n=t.id.split(`:`);t.value=e.toRating(t.value),t.id=n[0];break}}}};const Oe={TT2:`title`,TP1:`artist`,TP2:`albumartist`,TAL:`album`,TYE:`year`,COM:`comment`,TRK:`track`,TPA:`disk`,TCO:`genre`,PIC:`picture`,TCM:`composer`,TOR:`originaldate`,TOT:`originalalbum`,TXT:`lyricist`,TP3:`conductor`,TPB:`label`,TT1:`grouping`,TT3:`subtitle`,TLA:`language`,TCR:`copyright`,WCP:`license`,TEN:`encodedby`,TSS:`encodersettings`,WAR:`website`,PCS:`podcast`,TCP:`compilation`,TDR:`date`,TS2:`albumartistsort`,TSA:`albumsort`,TSC:`composersort`,TSP:`artistsort`,TST:`titlesort`,WFD:`podcasturl`,TBP:`bpm`};var ke=class extends J{constructor(){super([`ID3v2.2`],Oe)}},Ae={Title:`title`,Artist:`artist`,Artists:`artists`,"Album Artist":`albumartist`,Album:`album`,Year:`date`,Originalyear:`originalyear`,Originaldate:`originaldate`,Releasedate:`releasedate`,Comment:`comment`,Track:`track`,Disc:`disk`,DISCNUMBER:`disk`,Genre:`genre`,"Cover Art (Front)":`picture`,"Cover Art (Back)":`picture`,Composer:`composer`,Lyrics:`lyrics`,ALBUMSORT:`albumsort`,TITLESORT:`titlesort`,WORK:`work`,ARTISTSORT:`artistsort`,ALBUMARTISTSORT:`albumartistsort`,COMPOSERSORT:`composersort`,Lyricist:`lyricist`,Writer:`writer`,Conductor:`conductor`,MixArtist:`remixer`,Arranger:`arranger`,Engineer:`engineer`,Producer:`producer`,DJMixer:`djmixer`,Mixer:`mixer`,Label:`label`,Grouping:`grouping`,Subtitle:`subtitle`,DiscSubtitle:`discsubtitle`,Compilation:`compilation`,BPM:`bpm`,Mood:`mood`,Media:`media`,CatalogNumber:`catalognumber`,MUSICBRAINZ_ALBUMSTATUS:`releasestatus`,MUSICBRAINZ_ALBUMTYPE:`releasetype`,RELEASECOUNTRY:`releasecountry`,Script:`script`,Language:`language`,Copyright:`copyright`,LICENSE:`license`,EncodedBy:`encodedby`,EncoderSettings:`encodersettings`,Barcode:`barcode`,ISRC:`isrc`,ASIN:`asin`,musicbrainz_trackid:`musicbrainz_recordingid`,musicbrainz_releasetrackid:`musicbrainz_trackid`,MUSICBRAINZ_ALBUMID:`musicbrainz_albumid`,MUSICBRAINZ_ARTISTID:`musicbrainz_artistid`,MUSICBRAINZ_ALBUMARTISTID:`musicbrainz_albumartistid`,MUSICBRAINZ_RELEASEGROUPID:`musicbrainz_releasegroupid`,MUSICBRAINZ_WORKID:`musicbrainz_workid`,MUSICBRAINZ_TRMID:`musicbrainz_trmid`,MUSICBRAINZ_DISCID:`musicbrainz_discid`,Acoustid_Id:`acoustid_id`,ACOUSTID_FINGERPRINT:`acoustid_fingerprint`,MUSICIP_PUID:`musicip_puid`,Weblink:`website`,REPLAYGAIN_TRACK_GAIN:`replaygain_track_gain`,REPLAYGAIN_TRACK_PEAK:`replaygain_track_peak`,MP3GAIN_MINMAX:`replaygain_track_minmax`,MP3GAIN_UNDO:`replaygain_undo`},je=class extends J{constructor(){super([`APEv2`],Ae)}},Me={"©nam":`title`,"©ART":`artist`,aART:`albumartist`,"----:com.apple.iTunes:Band":`albumartist`,"©alb":`album`,"©day":`date`,"©cmt":`comment`,"©com":`comment`,trkn:`track`,disk:`disk`,"©gen":`genre`,covr:`picture`,"©wrt":`composer`,"©lyr":`lyrics`,soal:`albumsort`,sonm:`titlesort`,soar:`artistsort`,soaa:`albumartistsort`,soco:`composersort`,"----:com.apple.iTunes:LYRICIST":`lyricist`,"----:com.apple.iTunes:CONDUCTOR":`conductor`,"----:com.apple.iTunes:REMIXER":`remixer`,"----:com.apple.iTunes:ENGINEER":`engineer`,"----:com.apple.iTunes:PRODUCER":`producer`,"----:com.apple.iTunes:DJMIXER":`djmixer`,"----:com.apple.iTunes:MIXER":`mixer`,"----:com.apple.iTunes:LABEL":`label`,"©grp":`grouping`,"----:com.apple.iTunes:SUBTITLE":`subtitle`,"----:com.apple.iTunes:DISCSUBTITLE":`discsubtitle`,cpil:`compilation`,tmpo:`bpm`,"----:com.apple.iTunes:MOOD":`mood`,"----:com.apple.iTunes:MEDIA":`media`,"----:com.apple.iTunes:CATALOGNUMBER":`catalognumber`,tvsh:`tvShow`,tvsn:`tvSeason`,tves:`tvEpisode`,sosn:`tvShowSort`,tven:`tvEpisodeId`,tvnn:`tvNetwork`,pcst:`podcast`,purl:`podcasturl`,"----:com.apple.iTunes:MusicBrainz Album Status":`releasestatus`,"----:com.apple.iTunes:MusicBrainz Album Type":`releasetype`,"----:com.apple.iTunes:MusicBrainz Album Release Country":`releasecountry`,"----:com.apple.iTunes:SCRIPT":`script`,"----:com.apple.iTunes:LANGUAGE":`language`,cprt:`copyright`,"©cpy":`copyright`,"----:com.apple.iTunes:LICENSE":`license`,"©too":`encodedby`,pgap:`gapless`,"----:com.apple.iTunes:BARCODE":`barcode`,"----:com.apple.iTunes:ISRC":`isrc`,"----:com.apple.iTunes:ASIN":`asin`,"----:com.apple.iTunes:NOTES":`comment`,"----:com.apple.iTunes:MusicBrainz Track Id":`musicbrainz_recordingid`,"----:com.apple.iTunes:MusicBrainz Release Track Id":`musicbrainz_trackid`,"----:com.apple.iTunes:MusicBrainz Album Id":`musicbrainz_albumid`,"----:com.apple.iTunes:MusicBrainz Artist Id":`musicbrainz_artistid`,"----:com.apple.iTunes:MusicBrainz Album Artist Id":`musicbrainz_albumartistid`,"----:com.apple.iTunes:MusicBrainz Release Group Id":`musicbrainz_releasegroupid`,"----:com.apple.iTunes:MusicBrainz Work Id":`musicbrainz_workid`,"----:com.apple.iTunes:MusicBrainz TRM Id":`musicbrainz_trmid`,"----:com.apple.iTunes:MusicBrainz Disc Id":`musicbrainz_discid`,"----:com.apple.iTunes:Acoustid Id":`acoustid_id`,"----:com.apple.iTunes:Acoustid Fingerprint":`acoustid_fingerprint`,"----:com.apple.iTunes:MusicIP PUID":`musicip_puid`,"----:com.apple.iTunes:fingerprint":`musicip_fingerprint`,"----:com.apple.iTunes:replaygain_track_gain":`replaygain_track_gain`,"----:com.apple.iTunes:replaygain_track_peak":`replaygain_track_peak`,"----:com.apple.iTunes:replaygain_album_gain":`replaygain_album_gain`,"----:com.apple.iTunes:replaygain_album_peak":`replaygain_album_peak`,"----:com.apple.iTunes:replaygain_track_minmax":`replaygain_track_minmax`,"----:com.apple.iTunes:replaygain_album_minmax":`replaygain_album_minmax`,"----:com.apple.iTunes:replaygain_undo":`replaygain_undo`,gnre:`genre`,"----:com.apple.iTunes:ALBUMARTISTSORT":`albumartistsort`,"----:com.apple.iTunes:ARTISTS":`artists`,"----:com.apple.iTunes:ORIGINALDATE":`originaldate`,"----:com.apple.iTunes:ORIGINALYEAR":`originalyear`,"----:com.apple.iTunes:RELEASEDATE":`releasedate`,desc:`description`,ldes:`longDescription`,"©mvn":`movement`,"©mvi":`movementIndex`,"©mvc":`movementTotal`,"©wrk":`work`,catg:`category`,egid:`podcastId`,hdvd:`hdVideo`,keyw:`keywords`,shwm:`showMovement`,stik:`stik`,rate:`rating`},Y=class extends J{constructor(){super([`iTunes`],Me)}postMap(e,t){switch(e.id){case`rate`:e.value={source:void 0,rating:Number.parseFloat(e.value)/100};break}}},Ne={TITLE:`title`,ARTIST:`artist`,ARTISTS:`artists`,ALBUMARTIST:`albumartist`,"ALBUM ARTIST":`albumartist`,ALBUM:`album`,DATE:`date`,ORIGINALDATE:`originaldate`,ORIGINALYEAR:`originalyear`,RELEASEDATE:`releasedate`,COMMENT:`comment`,TRACKNUMBER:`track`,DISCNUMBER:`disk`,GENRE:`genre`,METADATA_BLOCK_PICTURE:`picture`,COMPOSER:`composer`,LYRICS:`lyrics`,ALBUMSORT:`albumsort`,TITLESORT:`titlesort`,WORK:`work`,ARTISTSORT:`artistsort`,ALBUMARTISTSORT:`albumartistsort`,COMPOSERSORT:`composersort`,LYRICIST:`lyricist`,WRITER:`writer`,CONDUCTOR:`conductor`,REMIXER:`remixer`,ARRANGER:`arranger`,ENGINEER:`engineer`,PRODUCER:`producer`,DJMIXER:`djmixer`,MIXER:`mixer`,LABEL:`label`,GROUPING:`grouping`,SUBTITLE:`subtitle`,DISCSUBTITLE:`discsubtitle`,TRACKTOTAL:`totaltracks`,DISCTOTAL:`totaldiscs`,COMPILATION:`compilation`,RATING:`rating`,BPM:`bpm`,KEY:`key`,MOOD:`mood`,MEDIA:`media`,CATALOGNUMBER:`catalognumber`,RELEASESTATUS:`releasestatus`,RELEASETYPE:`releasetype`,RELEASECOUNTRY:`releasecountry`,SCRIPT:`script`,LANGUAGE:`language`,COPYRIGHT:`copyright`,LICENSE:`license`,ENCODEDBY:`encodedby`,ENCODERSETTINGS:`encodersettings`,BARCODE:`barcode`,ISRC:`isrc`,ASIN:`asin`,MUSICBRAINZ_TRACKID:`musicbrainz_recordingid`,MUSICBRAINZ_RELEASETRACKID:`musicbrainz_trackid`,MUSICBRAINZ_ALBUMID:`musicbrainz_albumid`,MUSICBRAINZ_ARTISTID:`musicbrainz_artistid`,MUSICBRAINZ_ALBUMARTISTID:`musicbrainz_albumartistid`,MUSICBRAINZ_RELEASEGROUPID:`musicbrainz_releasegroupid`,MUSICBRAINZ_WORKID:`musicbrainz_workid`,MUSICBRAINZ_TRMID:`musicbrainz_trmid`,MUSICBRAINZ_DISCID:`musicbrainz_discid`,ACOUSTID_ID:`acoustid_id`,ACOUSTID_ID_FINGERPRINT:`acoustid_fingerprint`,MUSICIP_PUID:`musicip_puid`,WEBSITE:`website`,NOTES:`notes`,TOTALTRACKS:`totaltracks`,TOTALDISCS:`totaldiscs`,DISCOGS_ARTIST_ID:`discogs_artist_id`,DISCOGS_ARTISTS:`artists`,DISCOGS_ARTIST_NAME:`artists`,DISCOGS_ALBUM_ARTISTS:`albumartist`,DISCOGS_CATALOG:`catalognumber`,DISCOGS_COUNTRY:`releasecountry`,DISCOGS_DATE:`originaldate`,DISCOGS_LABEL:`label`,DISCOGS_LABEL_ID:`discogs_label_id`,DISCOGS_MASTER_RELEASE_ID:`discogs_master_release_id`,DISCOGS_RATING:`discogs_rating`,DISCOGS_RELEASED:`date`,DISCOGS_RELEASE_ID:`discogs_release_id`,DISCOGS_VOTES:`discogs_votes`,CATALOGID:`catalognumber`,STYLE:`genre`,REPLAYGAIN_TRACK_GAIN:`replaygain_track_gain`,REPLAYGAIN_TRACK_PEAK:`replaygain_track_peak`,REPLAYGAIN_ALBUM_GAIN:`replaygain_album_gain`,REPLAYGAIN_ALBUM_PEAK:`replaygain_album_peak`,REPLAYGAIN_MINMAX:`replaygain_track_minmax`,REPLAYGAIN_ALBUM_MINMAX:`replaygain_album_minmax`,REPLAYGAIN_UNDO:`replaygain_undo`},Pe=class e extends q{static toRating(e,t,n){return{source:e?e.toLowerCase():void 0,rating:Number.parseFloat(t)/n*q.maxRatingScore}}constructor(){super([`vorbis`],Ne)}postMap(t){if(t.id===`RATING`)t.value=e.toRating(void 0,t.value,100);else if(t.id.indexOf(`RATING:`)===0){let n=t.id.split(`:`);t.value=e.toRating(n[1],t.value,1),t.id=n[0]}}};const Fe={IART:`artist`,ICRD:`date`,INAM:`title`,TITL:`title`,IPRD:`album`,ITRK:`track`,IPRT:`track`,COMM:`comment`,ICMT:`comment`,ICNT:`releasecountry`,GNRE:`genre`,IWRI:`writer`,RATE:`rating`,YEAR:`year`,ISFT:`encodedby`,CODE:`encodedby`,TURL:`website`,IGNR:`genre`,IENG:`engineer`,ITCH:`technician`,IMED:`media`,IRPD:`album`};var Ie=class extends q{constructor(){super([`exif`],Fe)}},Le={"segment:title":`title`,"album:ARTIST":`albumartist`,"album:ARTISTSORT":`albumartistsort`,"album:TITLE":`album`,"album:DATE_RECORDED":`originaldate`,"album:DATE_RELEASED":`releasedate`,"album:PART_NUMBER":`disk`,"album:TOTAL_PARTS":`totaltracks`,"track:ARTIST":`artist`,"track:ARTISTSORT":`artistsort`,"track:TITLE":`title`,"track:PART_NUMBER":`track`,"track:MUSICBRAINZ_TRACKID":`musicbrainz_recordingid`,"track:MUSICBRAINZ_ALBUMID":`musicbrainz_albumid`,"track:MUSICBRAINZ_ARTISTID":`musicbrainz_artistid`,"track:PUBLISHER":`label`,"track:GENRE":`genre`,"track:ENCODER":`encodedby`,"track:ENCODER_OPTIONS":`encodersettings`,"edition:TOTAL_PARTS":`totaldiscs`,picture:`picture`},Re=class extends J{constructor(){super([`matroska`],Le)}},ze={NAME:`title`,AUTH:`artist`,"(c) ":`copyright`,ANNO:`comment`},Be=class extends q{constructor(){super([`AIFF`],ze)}},Ve=class{constructor(){this.tagMappers={},[new Ce,new ke,new Te,new Y,new Y,new Pe,new je,new De,new Ie,new Re,new Be].forEach(e=>{this.registerTagMapper(e)})}mapTag(e,t,n){if(this.tagMappers[e])return this.tagMappers[e].mapGenericTag(t,n);throw new v(`No generic tag mapper defined for tag-format: ${e}`)}registerTagMapper(e){for(let t of e.tagTypes)this.tagMappers[t]=e}},X=/\[(\d{2}):(\d{2})\.(\d{2,3})]/;function He(e){return X.test(e)?We(e):Ue(e)}function Ue(e){return{contentType:j.lyrics,timeStampFormat:A.notSynchronized,text:e.trim(),syncText:[]}}function We(e){let t=e.split(`
`),n=[];for(let e of t){let t=e.match(X);if(t){let r=Number.parseInt(t[1],10),i=Number.parseInt(t[2],10),a=t[3].length===3?Number.parseInt(t[3],10):Number.parseInt(t[3],10)*10,o=(r*60+i)*1e3+a,s=e.replace(X,``).trim();n.push({timestamp:o,text:s})}}return{contentType:j.lyrics,timeStampFormat:A.milliseconds,text:n.map(e=>e.text).join(`
`),syncText:n}}var Z=(0,l(b(),1).default)(`music-metadata:collector`),Ge=[`matroska`,`APEv2`,`vorbis`,`ID3v2.4`,`ID3v2.3`,`ID3v2.2`,`exif`,`asf`,`iTunes`,`AIFF`,`ID3v1`],Ke=class{constructor(e){this.format={tagTypes:[],trackInfo:[]},this.native={},this.common={track:{no:null,of:null},disk:{no:null,of:null},movementIndex:{no:null,of:null}},this.quality={warnings:[]},this.commonOrigin={},this.originPriority={},this.tagMapper=new Ve,this.opts=e;let t=1;for(let e of Ge)this.originPriority[e]=t++;this.originPriority.artificial=500,this.originPriority.id3v1=600}hasAny(){return Object.keys(this.native).length>0}addStreamInfo(e){Z(`streamInfo: type=${e.type?ne[e.type]:`?`}, codec=${e.codecName}`),this.format.trackInfo.push(e)}setFormat(e,t){Z(`format: ${e} = ${t}`),this.format[e]=t,this.opts?.observer&&this.opts.observer({metadata:this,tag:{type:`format`,id:e,value:t}})}setAudioOnly(){this.setFormat(`hasAudio`,!0),this.setFormat(`hasVideo`,!1)}async addTag(e,t,n){Z(`tag ${e}.${t} = ${n}`),this.native[e]||(this.format.tagTypes.push(e),this.native[e]=[]),this.native[e].push({id:t,value:n}),await this.toCommon(e,t,n)}addWarning(e){this.quality.warnings.push({message:e})}async postMap(e,t){switch(t.id){case`artist`:if(this.commonOrigin.artist===this.originPriority[e])return this.postMap(`artificial`,{id:`artists`,value:t.value});this.common.artists||this.setGenericTag(`artificial`,{id:`artists`,value:t.value});break;case`artists`:if((!this.common.artist||this.commonOrigin.artist===this.originPriority.artificial)&&(!this.common.artists||this.common.artists.indexOf(t.value)===-1)){let e={id:`artist`,value:qe((this.common.artists||[]).concat([t.value]))};this.setGenericTag(`artificial`,e)}break;case`picture`:return this.postFixPicture(t.value).then(n=>{n!==null&&(t.value=n,this.setGenericTag(e,t))});case`totaltracks`:this.common.track.of=q.toIntOrNull(t.value);return;case`totaldiscs`:this.common.disk.of=q.toIntOrNull(t.value);return;case`movementTotal`:this.common.movementIndex.of=q.toIntOrNull(t.value);return;case`track`:case`disk`:case`movementIndex`:{let e=this.common[t.id].of;this.common[t.id]=q.normalizeTrack(t.value),this.common[t.id].of=e??this.common[t.id].of;return}case`bpm`:case`year`:case`originalyear`:t.value=Number.parseInt(t.value,10);break;case`date`:{let e=Number.parseInt(t.value.substr(0,4),10);Number.isNaN(e)||(this.common.year=e);break}case`discogs_label_id`:case`discogs_release_id`:case`discogs_master_release_id`:case`discogs_artist_id`:case`discogs_votes`:t.value=typeof t.value==`string`?Number.parseInt(t.value,10):t.value;break;case`replaygain_track_gain`:case`replaygain_track_peak`:case`replaygain_album_gain`:case`replaygain_album_peak`:t.value=O(t.value);break;case`replaygain_track_minmax`:t.value=t.value.split(`,`).map(e=>Number.parseInt(e,10));break;case`replaygain_undo`:{let e=t.value.split(`,`).map(e=>Number.parseInt(e,10));t.value={leftChannel:e[0],rightChannel:e[1]};break}case`gapless`:case`compilation`:case`podcast`:case`showMovement`:t.value=t.value===`1`||t.value===1;break;case`isrc`:{let e=this.common[t.id];if(e&&e.indexOf(t.value)!==-1)return;break}case`comment`:typeof t.value==`string`&&(t.value={text:t.value}),t.value.descriptor===`iTunPGAP`&&this.setGenericTag(e,{id:`gapless`,value:t.value.text===`1`});break;case`lyrics`:typeof t.value==`string`&&(t.value=He(t.value));break;default:}t.value!==null&&this.setGenericTag(e,t)}toCommonMetadata(){return{format:this.format,native:this.native,quality:this.quality,common:this.common}}async postFixPicture(e){if(e.data&&e.data.length>0){if(!e.format){let t=await H(Uint8Array.from(e.data));if(t)e.format=t.mime;else return null}switch(e.format=e.format.toLocaleLowerCase(),e.format){case`image/jpg`:e.format=`image/jpeg`}return e}return this.addWarning(`Empty picture tag found`),null}async toCommon(e,t,n){let r={id:t,value:n},i=this.tagMapper.mapTag(e,r,this);i&&await this.postMap(e,i)}setGenericTag(e,t){Z(`common.${t.id} = ${t.value}`);let n=this.commonOrigin[t.id]||1e3,r=this.originPriority[e];if(be(t.id))if(r<=n)this.common[t.id]=t.value,this.commonOrigin[t.id]=r;else return Z(`Ignore native tag (singleton): ${e}.${t.id} = ${t.value}`);else if(r===n)!xe(t.id)||this.common[t.id].indexOf(t.value)===-1?this.common[t.id].push(t.value):Z(`Ignore duplicate value: ${e}.${t.id} = ${t.value}`);else if(r<n)this.common[t.id]=[t.value],this.commonOrigin[t.id]=r;else return Z(`Ignore native tag (list): ${e}.${t.id} = ${t.value}`);this.opts?.observer&&this.opts.observer({metadata:this,tag:{type:`common`,id:t.id,value:t.value}})}};function qe(e){return e.length>2?`${e.slice(0,e.length-1).join(`, `)} & ${e[e.length-1]}`:e.join(` & `)}const Je={parserType:`mpeg`,extensions:[`.mp2`,`.mp3`,`.m2a`,`.aac`,`aacp`],mimeTypes:[`audio/mpeg`,`audio/mp3`,`audio/aacs`,`audio/aacp`],async load(){return(await a(async()=>{let{MpegParser:e}=await import(`./MpegParser-Dv31HPmm.js`);return{MpegParser:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))).MpegParser}},Ye={parserType:`apev2`,extensions:[`.ape`],mimeTypes:[`audio/ape`,`audio/monkeys-audio`],async load(){return(await a(async()=>{let{APEv2Parser:e}=await import(`./APEv2Parser-BIvlT_8k.js`);return{APEv2Parser:e}},__vite__mapDeps([11,3,1,2,4,5,6]))).APEv2Parser}},Xe={parserType:`asf`,extensions:[`.asf`],mimeTypes:[`audio/ms-wma`,`video/ms-wmv`,`audio/ms-asf`,`video/ms-asf`,`application/vnd.ms-asf`],async load(){return(await a(async()=>{let{AsfParser:e}=await import(`./AsfParser-CNoLttF9.js`);return{AsfParser:e}},__vite__mapDeps([12,1,2,3,5,10,13]))).AsfParser}},Ze={parserType:`dsdiff`,extensions:[`.dff`],mimeTypes:[`audio/dsf`,`audio/dsd`],async load(){return(await a(async()=>{let{DsdiffParser:e}=await import(`./DsdiffParser-DS9Zbw_z.js`);return{DsdiffParser:e}},__vite__mapDeps([14,1,2,3,4,5,6,7,9,10]))).DsdiffParser}},Qe={parserType:`aiff`,extensions:[`.aif`,`aiff`,`aifc`],mimeTypes:[`audio/aiff`,`audio/aif`,`audio/aifc`,`application/aiff`],async load(){return(await a(async()=>{let{AIFFParser:e}=await import(`./AiffParser-DeEBWuiR.js`);return{AIFFParser:e}},__vite__mapDeps([15,1,2,3,4,5,6,7,9,10]))).AIFFParser}},$e={parserType:`dsf`,extensions:[`.dsf`],mimeTypes:[`audio/dsf`],async load(){return(await a(async()=>{let{DsfParser:e}=await import(`./DsfParser-D2L0jsK3.js`);return{DsfParser:e}},__vite__mapDeps([16,1,2,3,4,5,6,7,8,9,10]))).DsfParser}},et={parserType:`flac`,extensions:[`.flac`],mimeTypes:[`audio/flac`],async load(){return(await a(async()=>{let{FlacParser:e}=await import(`./FlacParser-vrFmITD9.js`);return{FlacParser:e}},__vite__mapDeps([17,3,1,2,4,5,6,18,8,7,9,10]))).FlacParser}},tt={parserType:`matroska`,extensions:[`.mka`,`.mkv`,`.mk3d`,`.mks`,`webm`],mimeTypes:[`audio/matroska`,`video/matroska`,`audio/webm`,`video/webm`],async load(){return(await a(async()=>{let{MatroskaParser:e}=await import(`./MatroskaParser-CV7Kr9Ox.js`);return{MatroskaParser:e}},__vite__mapDeps([19,1,2,3,13,6]))).MatroskaParser}},nt={parserType:`mp4`,extensions:[`.mp4`,`.m4a`,`.m4b`,`.m4pa`,`m4v`,`m4r`,`3gp`,`.mov`,`.movie`,`.qt`],mimeTypes:[`audio/mp4`,`audio/m4a`,`video/m4v`,`video/mp4`,`video/quicktime`],async load(){return(await a(async()=>{let{MP4Parser:e}=await import(`./MP4Parser-AX0GHFWk.js`);return{MP4Parser:e}},__vite__mapDeps([20,1,2,3,4,5,6,7,13]))).MP4Parser}},rt={parserType:`musepack`,extensions:[`.mpc`],mimeTypes:[`audio/musepack`],async load(){return(await a(async()=>{let{MusepackParser:e}=await import(`./MusepackParser-hl--qYF_.js`);return{MusepackParser:e}},__vite__mapDeps([21,1,2,3,4,5,6,7,8,9,10]))).MusepackParser}},it={parserType:`ogg`,extensions:[`.ogg`,`.ogv`,`.oga`,`.ogm`,`.ogx`,`.opus`,`.spx`],mimeTypes:[`audio/ogg`,`audio/opus`,`audio/speex`,`video/ogg`],async load(){return(await a(async()=>{let{OggParser:e}=await import(`./OggParser-DsMPsRkA.js`);return{OggParser:e}},__vite__mapDeps([22,1,2,3,4,5,6,18,8,7,9,10]))).OggParser}},at={parserType:`wavpack`,extensions:[`.wv`,`.wvp`],mimeTypes:[`audio/wavpack`],async load(){return(await a(async()=>{let{WavPackParser:e}=await import(`./WavPackParser-CezWDVXy.js`);return{WavPackParser:e}},__vite__mapDeps([23,1,2,3,4,5,6]))).WavPackParser}},ot={parserType:`riff`,extensions:[`.wav`,`wave`,`.bwf`],mimeTypes:[`audio/vnd.wave`,`audio/wav`,`audio/wave`],async load(){return(await a(async()=>{let{WaveParser:e}=await import(`./WaveParser-DE_8-d3R.js`);return{WaveParser:e}},__vite__mapDeps([24,1,2,3,4,5,6,7,9,10]))).WaveParser}};var Q=(0,l(b(),1).default)(`music-metadata:parser:factory`);function st(e){let t=ye.parse(e),n=(0,ve.parse)(t.type);return{type:n.type,subtype:n.subtype,suffix:n.suffix,parameters:t.parameters}}var ct=class{constructor(){this.parsers=[],[et,Je,Ye,nt,tt,ot,it,Xe,Qe,at,rt,$e,Ze].forEach(e=>{this.registerParser(e)})}registerParser(e){this.parsers.push(e)}async parse(e,t,n){if(e.supportsRandomAccess()?(Q(`tokenizer supports random-access, scanning for appending headers`),await pt(e,n)):Q(`tokenizer does not support random-access, cannot scan for appending headers`),!t){let n=new Uint8Array(4100);if(e.fileInfo.mimeType&&(t=this.findLoaderForContentType(e.fileInfo.mimeType)),!t&&e.fileInfo.path&&(t=this.findLoaderForExtension(e.fileInfo.path)),!t){Q(`Guess parser on content...`),await e.peekBuffer(n,{mayBeLess:!0});let r=await H(n,{mpegOffsetTolerance:10});if(!r||!r.mime)throw new y(`Failed to determine audio format`);if(Q(`Guessed file type is mime=${r.mime}, extension=${r.ext}`),t=this.findLoaderForContentType(r.mime),!t)throw new g(`Guessed MIME-type not supported: ${r.mime}`)}}Q(`Loading ${t.parserType} parser...`);let r=new Ke(n),i=new(await(t.load()))(r,e,n??{});return Q(`Parser ${t.parserType} loaded`),await i.parse(),r.format.trackInfo&&(r.format.hasAudio===void 0&&r.setFormat(`hasAudio`,!!r.format.trackInfo.find(e=>e.type===N.audio)),r.format.hasVideo===void 0&&r.setFormat(`hasVideo`,!!r.format.trackInfo.find(e=>e.type===N.video))),r.toCommonMetadata()}findLoaderForExtension(e){if(!e)return;let t=lt(e).toLocaleLowerCase()||e;return this.parsers.find(e=>e.extensions.indexOf(t)!==-1)}findLoaderForContentType(e){let t;if(!e)return;try{t=st(e)}catch{Q(`Invalid HTTP Content-Type header value: ${e}`);return}let n=t.subtype.indexOf(`x-`)===0?t.subtype.substring(2):t.subtype;return this.parsers.find(e=>e.mimeTypes.find(e=>e.indexOf(`${t.type}/${n}`)!==-1))}getSupportedMimeTypes(){let e=new Set;return this.parsers.forEach(t=>{t.mimeTypes.forEach(t=>{e.add(t),e.add(t.replace(`/`,`/x-`))})}),Array.from(e)}};function lt(e){let t=e.lastIndexOf(`.`);return t===-1?``:e.substring(t)}async function ut(e){let t=e.fileInfo.size;if(t>=143){let n=new Uint8Array(15),r=e.position;await e.readBuffer(n,{position:t-143}),e.setPosition(r);let i=ee(n,`latin1`);if(i.substring(6)===`LYRICS200`)return Number.parseInt(i.substring(0,6),10)+15}return 0}async function dt(e,t={}){let n=E(e);try{return await ft(n,t)}finally{await n.close()}}function ft(e,t){return new ct().parse(e,void 0,t)}async function pt(e,t={}){let n=e.fileInfo.size;if(await te(e)){n-=128;let t=await ut(e);n-=t}t.apeHeader=await M.findApeFooterOffset(e,n)}var $=e();function mt(e){let t=new Blob([e.data],{type:e.format}),n=`cover.${e.format.split(`/`)[1]}`;return new File([t],n,{type:e.format})}var ht=[`audio/mpeg`,`audio/wav`,`audio/mp4`,`audio/aac`,`audio/ogg`];function gt(){let e=(0,ie.c)(27),t=n(),[i,a]=(0,P.useState)(!1),o=(0,P.useRef)(null),[s,c]=(0,P.useState)(!1),l,u;e[0]===Symbol.for(`react.memo_cache_sentinel`)?(l=()=>{let e=o.current;if(!e)return;let t=()=>{c(!1)};return e.addEventListener(`cancel`,t),()=>e.removeEventListener(`cancel`,t)},u=[],e[0]=l,e[1]=u):(l=e[0],u=e[1]),(0,P.useEffect)(l,u);let d=vt,f;e[2]===t?f=e[3]:(f=async e=>{for(let t of e)await d(t);t({to:`/library`})},e[2]=t,e[3]=f);let p=f,m;e[4]===p?m=e[5]:(m=async e=>{!e||!e.item(0)||await p(e)},e[4]=p,e[5]=m);let h=m,g;e[6]===Symbol.for(`react.memo_cache_sentinel`)?(g=e=>{e.preventDefault(),a(!0)},e[6]=g):g=e[6];let _=g,v;e[7]===Symbol.for(`react.memo_cache_sentinel`)?(v=()=>{a(!1)},e[7]=v):v=e[7];let ee=v,y;e[8]===p?y=e[9]:(y=async e=>{e.preventDefault(),a(!1);let t=e.dataTransfer.files,n=Array.from(t).filter(_t);if(n.length>0)return alert(`Only audio files are allowed!`),console.log(`Invalid files:`,n),!1;await p(t)},e[8]=p,e[9]=y);let b=y,x;e[10]===Symbol.for(`react.memo_cache_sentinel`)?(x=()=>{c(!0),o.current?.click()},e[10]=x):x=e[10];let S=x,C;e[11]===Symbol.for(`react.memo_cache_sentinel`)?(C=(0,$.jsx)(`div`,{className:`flex items-center justify-center`,children:(0,$.jsx)(`h2`,{className:`text-xl font-bold`,children:`Import Music`})}),e[11]=C):C=e[11];let w=`border-2 border-dashed rounded-2xl p-8 text-center transition-colors ${i?`border-primary bg-primary/10`:`border-border hover:border-primary/50`}`,T,E,D;e[12]===Symbol.for(`react.memo_cache_sentinel`)?(T=(0,$.jsx)(`div`,{className:`w-16 h-16 mx-auto mb-4 rounded-full bg-secondary flex items-center justify-center`,children:(0,$.jsx)(r,{size:32,className:`text-muted-foreground`})}),E=(0,$.jsx)(`p`,{className:`font-medium mb-2`,children:`Drag & drop audio files here`}),D=(0,$.jsx)(`p`,{className:`text-sm text-muted-foreground mb-4`,children:`Supports MP3, WAV, FLAC, AAC`}),e[12]=T,e[13]=E,e[14]=D):(T=e[12],E=e[13],D=e[14]);let O;e[15]===h?O=e[16]:(O=(0,$.jsx)(`input`,{ref:o,type:`file`,accept:`.mp3,.wav,.m4a,audio/*`,className:`hidden`,multiple:!0,onChange:e=>{h?.(e.currentTarget.files),c(!1)}}),e[15]=h,e[16]=O);let k;e[17]!==s||e[18]!==O?(k=(0,$.jsxs)(`button`,{onClick:S,disabled:s,className:`disabled:cursor-not-allowed cursor-pointer w-full flex items-center justify-center p-3 rounded-xl transition-colors bg-primary/10 text-primary`,children:[O,`Choose Files`]}),e[17]=s,e[18]=O,e[19]=k):k=e[19];let A;e[20]!==b||e[21]!==k||e[22]!==w?(A=(0,$.jsxs)(`div`,{onDragOver:_,onDragLeave:ee,onDrop:b,className:w,children:[T,E,D,k]}),e[20]=b,e[21]=k,e[22]=w,e[23]=A):A=e[23];let j;e[24]===Symbol.for(`react.memo_cache_sentinel`)?(j=(0,$.jsx)(`p`,{className:`text-xs text-center text-muted-foreground`,children:`Note: upload only audio files`}),e[24]=j):j=e[24];let M;return e[25]===A?M=e[26]:(M=(0,$.jsx)(`div`,{className:`flex justify-center items-center`,children:(0,$.jsxs)(`div`,{className:`flex flex-col gap-4 p-4 justify-center`,children:[C,A,j]})}),e[25]=A,e[26]=M),M}function _t(e){return!ht.includes(e.type)}async function vt(e){let t=await u(e),n=await dt(e),r=n.common.title||e.name.replace(/\.[^/.]+$/,``)||`uploaded`,a=n.common.artist||`Unknown`,o=n.common.album||`Unknown`,s;n.common.picture?.[0]&&(s=(await u(mt(n.common.picture[0]))).id),await i({title:r,artist:a,album:o,duration:Math.floor(n.format.duration||0),audioId:t.id,coverImageId:s,addedAt:new Date})}var yt=c();function bt(){let e=(0,yt.c)(1),t;return e[0]===Symbol.for(`react.memo_cache_sentinel`)?(t=(0,$.jsx)(gt,{}),e[0]=t):t=e[0],t}export{bt as component};